@reference "../../../css/app.css";

@layer components {
    .markdown-editor *:not(pre, code) {
        @apply text-base;
    }

    .markdown-editor pre,
    .markdown-editor code {
        @apply font-mono text-xs;
    }

    /* CodeMirror Base Styles */
    .CodeMirror {
        @apply relative h-[300px] overflow-hidden bg-white font-mono text-black;
    }

    .CodeMirror-lines {
        @apply min-h-[1px] cursor-text py-1;
    }

    .CodeMirror pre.CodeMirror-line,
    .CodeMirror pre.CodeMirror-line-like {
        @apply relative z-[2] m-0 overflow-visible rounded-none border-0 bg-transparent px-1 whitespace-pre text-inherit normal-case;
        -webkit-tap-highlight-color: transparent;
        -webkit-font-variant-ligatures: contextual;
        font-variant-ligatures: contextual;
    }

    .CodeMirror-gutter-filler,
    .CodeMirror-scrollbar-filler {
        @apply bg-white;
    }

    .CodeMirror-gutters {
        @apply absolute top-0 left-0 z-[3] min-h-full border-r border-gray-300 bg-gray-50 whitespace-nowrap;
    }

    .CodeMirror-linenumber {
        @apply min-w-[20px] px-1 py-0 pl-[5px] text-right whitespace-nowrap text-gray-500;
    }

    .CodeMirror-guttermarker {
        @apply text-black;
    }

    .CodeMirror-guttermarker-subtle {
        @apply text-gray-500;
    }

    .CodeMirror-cursor {
        @apply pointer-events-none absolute w-0 border-r-0 border-l border-black;
    }

    .CodeMirror div.CodeMirror-secondarycursor {
        @apply border-l border-gray-400;
    }

    .cm-fat-cursor .CodeMirror-cursor {
        @apply w-auto border-0 bg-[#7e7];
    }

    .cm-fat-cursor div.CodeMirror-cursors {
        @apply z-[1];
    }

    .cm-fat-cursor .CodeMirror-line::selection,
    .cm-fat-cursor .CodeMirror-line > span::selection,
    .cm-fat-cursor .CodeMirror-line > span > span::selection {
        @apply bg-transparent;
    }

    .cm-fat-cursor .CodeMirror-line::-moz-selection,
    .cm-fat-cursor .CodeMirror-line > span::-moz-selection,
    .cm-fat-cursor .CodeMirror-line > span > span::-moz-selection {
        @apply bg-transparent;
    }

    .cm-fat-cursor {
        caret-color: transparent;
    }

    @-moz-keyframes blink {
        50% {
            background-color: transparent;
        }
    }

    @-webkit-keyframes blink {
        50% {
            background-color: transparent;
        }
    }

    @keyframes blink {
        50% {
            background-color: transparent;
        }
    }

    .cm-tab {
        @apply inline-block;
        text-decoration: inherit;
    }

    .CodeMirror-rulers {
        @apply absolute top-[-50px] right-0 bottom-0 left-0 overflow-hidden;
    }

    .CodeMirror-ruler {
        @apply absolute top-0 bottom-0 border-l border-gray-300;
    }

    /* Syntax Highlighting */
    .cm-s-default .cm-header {
        @apply text-blue-600;
    }

    .cm-s-default .cm-quote {
        @apply text-green-600;
    }

    .cm-negative {
        @apply text-red-600;
    }

    .cm-positive {
        @apply text-green-600;
    }

    .cm-header,
    .cm-strong {
        @apply font-bold;
    }

    .cm-em {
        @apply italic;
    }

    .cm-link {
        @apply underline;
    }

    .cm-strikethrough {
        @apply line-through;
    }

    .cm-s-default .cm-keyword {
        @apply text-purple-700;
    }

    .cm-s-default .cm-atom {
        @apply text-blue-700;
    }

    .cm-s-default .cm-number {
        @apply text-green-700;
    }

    .cm-s-default .cm-def {
        @apply text-blue-600;
    }

    .cm-s-default .cm-variable-2 {
        @apply text-blue-600;
    }

    .cm-s-default .cm-type,
    .cm-s-default .cm-variable-3 {
        @apply text-teal-600;
    }

    .cm-s-default .cm-comment {
        @apply text-orange-600;
    }

    .cm-s-default .cm-string {
        @apply text-red-700;
    }

    .cm-s-default .cm-string-2 {
        @apply text-orange-600;
    }

    .cm-s-default .cm-meta {
        @apply text-gray-600;
    }

    .cm-s-default .cm-qualifier {
        @apply text-gray-600;
    }

    .cm-s-default .cm-builtin {
        @apply text-blue-700;
    }

    .cm-s-default .cm-bracket {
        @apply text-gray-600;
    }

    .cm-s-default .cm-tag {
        @apply text-green-800;
    }

    .cm-s-default .cm-attribute {
        @apply text-blue-700;
    }

    .cm-s-default .cm-hr {
        @apply text-gray-500;
    }

    .cm-s-default .cm-link {
        @apply text-blue-700;
    }

    .cm-s-default .cm-error {
        @apply text-red-600;
    }

    .cm-invalidchar {
        @apply text-red-600;
    }

    .CodeMirror-composing {
        @apply border-b-2 border-solid;
    }

    div.CodeMirror span.CodeMirror-matchingbracket {
        @apply text-green-600;
    }

    div.CodeMirror span.CodeMirror-nonmatchingbracket {
        @apply text-red-700;
    }

    .CodeMirror-matchingtag {
        background: rgba(255, 150, 0, 0.3);
    }

    .CodeMirror-activeline-background {
        @apply bg-blue-50;
    }

    /* Scrollbar and Layout */
    .CodeMirror-scroll {
        @apply relative z-0 mr-[-50px] mb-[-50px] h-full overflow-scroll pb-[50px] outline-none;
    }

    .CodeMirror-sizer {
        @apply relative border-r-[50px] border-transparent;
    }

    .CodeMirror-gutter-filler,
    .CodeMirror-hscrollbar,
    .CodeMirror-scrollbar-filler,
    .CodeMirror-vscrollbar {
        @apply absolute z-[6] hidden outline-none;
    }

    .CodeMirror-vscrollbar {
        @apply top-0 right-0 overflow-x-hidden overflow-y-scroll;
    }

    .CodeMirror-hscrollbar {
        @apply bottom-0 left-0 overflow-x-scroll overflow-y-hidden;
    }

    .CodeMirror-scrollbar-filler {
        @apply right-0 bottom-0;
    }

    .CodeMirror-gutter-filler {
        @apply bottom-0 left-0;
    }

    .CodeMirror-gutter {
        @apply mb-[-50px] inline-block h-full align-top whitespace-normal;
    }

    .CodeMirror-gutter-wrapper {
        @apply absolute z-[4] border-none bg-transparent;
    }

    .CodeMirror-gutter-background {
        @apply absolute top-0 bottom-0 z-[4];
    }

    .CodeMirror-gutter-elt {
        @apply absolute z-[4] cursor-default;
    }

    .CodeMirror-gutter-wrapper ::selection {
        @apply bg-transparent;
    }

    .CodeMirror-gutter-wrapper ::-moz-selection {
        @apply bg-transparent;
    }

    /* Line Wrapping */
    .CodeMirror-wrap pre.CodeMirror-line,
    .CodeMirror-wrap pre.CodeMirror-line-like {
        word-wrap: break-word;
        @apply whitespace-pre-wrap;
        word-break: normal;
    }

    .CodeMirror-linebackground {
        @apply absolute top-0 right-0 bottom-0 left-0 z-0;
    }

    .CodeMirror-linewidget {
        @apply relative z-[2] p-[0.1px];
    }

    .CodeMirror-rtl pre {
        text-align: right;
    }

    .CodeMirror-code {
        @apply outline-none;
    }

    .CodeMirror-gutter,
    .CodeMirror-gutters,
    .CodeMirror-linenumber,
    .CodeMirror-scroll,
    .CodeMirror-sizer {
        box-sizing: content-box;
    }

    .CodeMirror-measure {
        @apply invisible absolute h-0 w-full overflow-hidden;
    }

    .CodeMirror-measure pre {
        @apply static;
    }

    div.CodeMirror-cursors {
        @apply invisible relative z-[3];
    }

    div.CodeMirror-dragcursors {
        @apply visible;
    }

    .CodeMirror-focused div.CodeMirror-cursors {
        @apply visible;
    }

    .CodeMirror-selected {
        @apply bg-gray-300;
    }

    .CodeMirror-focused .CodeMirror-selected {
        @apply bg-indigo-200;
    }

    .CodeMirror-crosshair {
        @apply cursor-crosshair;
    }

    .CodeMirror-line::selection,
    .CodeMirror-line > span::selection,
    .CodeMirror-line > span > span::selection {
        @apply bg-indigo-200;
    }

    .CodeMirror-line::-moz-selection,
    .CodeMirror-line > span::-moz-selection,
    .CodeMirror-line > span > span::-moz-selection {
        @apply bg-indigo-200;
    }

    .cm-searching {
        @apply bg-yellow-200;
        background-color: rgba(255, 255, 0, 0.4);
    }

    .cm-force-border {
        padding-right: 0.1px;
    }

    @media print {
        .CodeMirror div.CodeMirror-cursors {
            @apply invisible;
        }
    }

    .cm-tab-wrap-hack:after {
        content: '';
    }

    span.CodeMirror-selectedtext {
        @apply bg-transparent;
    }

    /* EasyMDE Container */
    .EasyMDEContainer {
        @apply block;
    }

    .CodeMirror-rtl pre {
        @apply text-right;
    }

    .EasyMDEContainer.sided--no-fullscreen {
        @apply flex flex-row flex-wrap;
    }

    .EasyMDEContainer .CodeMirror {
        @apply z-0 box-border h-auto rounded-b border border-gray-300 p-[10px];
        word-wrap: break-word;
    }

    .EasyMDEContainer .CodeMirror-scroll {
        @apply cursor-text;
    }

    .EasyMDEContainer .CodeMirror-fullscreen {
        @apply fixed top-[50px] right-0 bottom-0 left-0 z-[8] h-auto rounded-br-none border-r-0 bg-white;
    }

    .EasyMDEContainer .CodeMirror-sided {
        @apply w-1/2;
    }

    .EasyMDEContainer.sided--no-fullscreen .CodeMirror-sided {
        @apply relative flex-auto rounded-br-none border-r-0;
    }

    .EasyMDEContainer .CodeMirror-placeholder {
        @apply opacity-50;
    }

    .EasyMDEContainer .CodeMirror-focused .CodeMirror-selected {
        @apply bg-gray-300;
    }

    /* Editor Toolbar */
    .editor-toolbar {
        @apply relative rounded-t border-t border-r border-l border-gray-300 bg-white px-[10px] py-[9px] select-none;
    }

    .editor-toolbar.fullscreen {
        @apply fixed top-0 left-0 z-[9] box-border h-[50px] w-full border-0 bg-white pt-[10px] pb-[10px] opacity-100;
    }

    .editor-toolbar.fullscreen::before {
        @apply fixed top-0 left-0 m-0 h-[50px] w-5 p-0;
        background: linear-gradient(to right, #fff 0%, rgba(255, 255, 255, 0) 100%);
    }

    .editor-toolbar.fullscreen::after {
        @apply fixed top-0 right-0 m-0 h-[50px] w-5 p-0;
        background: linear-gradient(to right, rgba(255, 255, 255, 0) 0%, #fff 100%);
    }

    .EasyMDEContainer.sided--no-fullscreen .editor-toolbar {
        @apply w-full;
    }

    .editor-toolbar .easymde-dropdown,
    .editor-toolbar button {
        @apply m-0 inline-block h-[30px] cursor-pointer rounded border border-transparent bg-transparent p-0 text-center no-underline;
    }

    .editor-toolbar button {
        @apply min-w-[30px] px-[6px] font-bold whitespace-nowrap;
    }

    .editor-toolbar button.active,
    .editor-toolbar button:hover {
        @apply border-gray-400 bg-gray-50;
    }

    .editor-toolbar i.separator {
        @apply mx-[6px] inline-block w-0 border-r border-l border-gray-300 border-white text-transparent;
        text-indent: -10px;
    }

    .editor-toolbar button:after {
        @apply relative top-[2px] align-text-bottom text-xs;
        font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif;
    }

    .editor-toolbar button.heading-1:after {
        content: '1';
    }

    .editor-toolbar button.heading-2:after {
        content: '2';
    }

    .editor-toolbar button.heading-3:after {
        content: '3';
    }

    .editor-toolbar button.heading-bigger:after {
        content: '▲';
    }

    .editor-toolbar button.heading-smaller:after {
        content: '▼';
    }

    .editor-toolbar.disabled-for-preview button:not(.no-disable) {
        @apply pointer-events-none opacity-60;
    }

    @media only screen and (max-width: 700px) {
        .editor-toolbar i.no-mobile {
            @apply hidden;
        }
    }

    /* Editor Status Bar */
    .editor-statusbar {
        @apply px-[10px] py-2 text-right text-xs text-gray-500;
    }

    .EasyMDEContainer.sided--no-fullscreen .editor-statusbar {
        @apply w-full;
    }

    .editor-statusbar span {
        @apply ml-4 inline-block min-w-[4em];
    }

    .editor-statusbar .lines:before {
        content: 'lines: ';
    }

    .editor-statusbar .words:before {
        content: 'words: ';
    }

    .editor-statusbar .characters:before {
        content: 'characters: ';
    }

    /* Editor Preview */
    .editor-preview-full {
        @apply absolute top-0 left-0 z-[7] box-border hidden h-full w-full overflow-auto;
    }

    .editor-preview-side {
        @apply fixed top-[50px] right-0 bottom-0 z-[9] box-border hidden w-1/2 overflow-auto border border-gray-300;
        word-wrap: break-word;
    }

    .editor-preview-active-side {
        @apply block;
    }

    .EasyMDEContainer.sided--no-fullscreen .editor-preview-active-side {
        @apply static h-auto flex-auto;
    }

    .editor-preview-active {
        @apply block;
    }

    .editor-preview {
        @apply bg-gray-50 p-[10px];
    }

    .editor-preview > p {
        @apply mt-0;
    }

    .editor-preview pre {
        @apply mb-[10px] bg-gray-200;
    }

    .editor-preview table td,
    .editor-preview table th {
        @apply border border-gray-300 p-[5px];
    }

    /* EasyMDE Theme */
    .cm-s-easymde .cm-tag {
        @apply text-green-600;
    }

    .cm-s-easymde .cm-attribute {
        @apply text-purple-600;
    }

    .cm-s-easymde .cm-string {
        @apply text-blue-800;
    }

    .editor-preview h1,
    .cm-s-easymde .cm-header-1 {
        @apply mb-2 leading-tight font-extrabold text-green-700;
    }

    .editor-preview h2,
    .cm-s-easymde .cm-header-2 {
        @apply mb-2 leading-tight font-bold text-cyan-700;
    }

    .editor-preview h3,
    .cm-s-easymde .cm-header-3 {
        @apply mb-2 leading-tight font-semibold text-teal-500;
    }

    .editor-preview h4,
    .cm-s-easymde .cm-header-4 {
        @apply mb-2 leading-tight font-medium text-gray-500;
    }

    .editor-preview h5,
    .cm-s-easymde .cm-header-5 {
        @apply mb-2 leading-tight font-medium text-green-400;
    }

    .editor-preview h6,
    .cm-s-easymde .cm-header-6 {
        @apply mb-2 text-base leading-tight font-medium;
    }

    .cm-s-easymde .cm-comment {
        @apply rounded bg-black/5;
    }

    .cm-s-easymde .cm-link {
        @apply text-gray-500;
    }

    .cm-s-easymde .cm-url {
        @apply text-gray-400;
    }

    .cm-s-easymde .cm-quote {
        @apply text-gray-500 italic;
    }

    /* Dropdown */
    .editor-toolbar .easymde-dropdown {
        @apply relative rounded-none border border-white;
        background: linear-gradient(to bottom right, #fff 0%, #fff 84%, #333 50%, #333 100%);
    }

    .editor-toolbar .easymde-dropdown:hover {
        background: linear-gradient(to bottom right, #fff 0%, #fff 84%, #333 50%, #333 100%);
    }

    .easymde-dropdown-content {
        @apply invisible absolute top-[30px] z-[2] block bg-gray-50 p-2 shadow-lg;
    }

    .easymde-dropdown:active .easymde-dropdown-content,
    .easymde-dropdown:focus .easymde-dropdown-content,
    .easymde-dropdown:focus-within .easymde-dropdown-content {
        @apply visible;
    }

    .easymde-dropdown-content button {
        @apply block;
    }

    /* Image Support */
    span[data-img-src]::after {
        content: '';
        background-image: var(--bg-image);
        @apply block h-0 max-h-full max-w-full bg-contain bg-no-repeat;
        padding-top: var(--height);
        width: var(--width);
    }

    /* Spell Check */
    .CodeMirror .cm-spell-error:not(.cm-url):not(.cm-comment):not(.cm-tag):not(.cm-word) {
        background: rgba(255, 0, 0, 0.15);
    }
}
